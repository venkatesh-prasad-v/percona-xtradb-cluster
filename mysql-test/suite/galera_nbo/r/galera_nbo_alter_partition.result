CREATE TABLE t1 (f1 INTEGER NOT NULL) ENGINE=InnoDB;
SET SESSION wsrep_osu_method=NBO;
ALTER TABLE t1 LOCK=SHARED PARTITION BY HASH(f1) PARTITIONS 8;
INSERT INTO t1 VALUES (1);
SHOW CREATE TABLE t1;
Table	Create Table
t1	CREATE TABLE `t1` (
  `f1` int NOT NULL
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_0900_ai_ci
/*!50100 PARTITION BY HASH (`f1`)
PARTITIONS 8 */
SELECT COUNT(*) = 1 FROM t1;
COUNT(*) = 1
1
ALTER TABLE t1 ANALYZE PARTITION p3,p4;
Table	Op	Msg_type	Msg_text
test.t1	analyze	status	OK
ALTER TABLE t1 LOCK=EXCLUSIVE, ALGORITHM=INPLACE, TRUNCATE PARTITION p3;
ALTER TABLE t1 LOCK=SHARED REMOVE PARTITIONING;
INSERT INTO t1 VALUES (2);
SHOW CREATE TABLE t1;
Table	Create Table
t1	CREATE TABLE `t1` (
  `f1` int NOT NULL
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_0900_ai_ci
SELECT COUNT(*) = 2 FROM t1;
COUNT(*) = 2
1
SET SESSION wsrep_osu_method=TOI;
DROP TABLE t1;
