CREATE TABLE t1 (f1 INTEGER);
INSERT INTO t1 VALUES (1),(2),(3),(4),(5),(1);
SET SESSION wsrep_OSU_method=NBO;
ALTER TABLE t1 LOCK=SHARED, ADD PRIMARY KEY (f1);
ERROR 23000: Duplicate entry '1' for key 'PRIMARY'
INSERT INTO t1 VALUES (1);
SHOW CREATE TABLE t1;
Table	Create Table
t1	CREATE TABLE `t1` (
  `f1` int(11) DEFAULT NULL
) ENGINE=InnoDB DEFAULT CHARSET=latin1
SHOW CREATE TABLE t1;
Table	Create Table
t1	CREATE TABLE `t1` (
  `f1` int(11) DEFAULT NULL
) ENGINE=InnoDB DEFAULT CHARSET=latin1
SELECT COUNT(*) =  7 FROM t1;
COUNT(*) =  7
1
ALTER IGNORE TABLE t1 LOCK=SHARED, ADD PRIMARY KEY (f1);
Warnings:
Warning	1681	'IGNORE' is deprecated and will be removed in a future release.
SELECT COUNT(*) = 5 FROM t1;
COUNT(*) = 5
1
SELECT COUNT(*) = 5 FROM t1;
COUNT(*) = 5
1
SET SESSION wsrep_OSU_method=TOI;
DROP TABLE t1;
